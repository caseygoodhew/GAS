<script>
const remoteCall = (options) => {
  
    const {handler, success, failure} = options;

    let api = google.script.run.withUserObject(options);

    if (success) {
      api = api.withSuccessHandler(success);
    }

    if (failure) {
      api = api.withFailureHandler(failure);
    }

    try {
      handler(api);
    } catch (e) {
      if (failure) {
        failure(e, options);
      } else {
        throw e;
      }
    }  
};
  

</script>
