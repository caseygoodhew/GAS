<script>
const predictorModuleController = (() => {

  const USE_SAMPLE_DATA = true;

  const constants = [
    'LAUNCHER',
    'REGISTRY', 
    //'ACTUALS', 
    'MOVEMENTS', 
    //'DEBUG'
  ].reduce((acc, val) => ({ ...acc, [val]: val }), {});
  
  const {
    LAUNCHER,
    REGISTRY,
    //ACTUALS,
    MOVEMENTS,
    //DEBUG
  } = constants;

  const INITIAL_MODULE = LAUNCHER;
  
  const moduleMap = {
    [LAUNCHER]: predictorLauncherModule,
    [REGISTRY]: predictorRegistryModule,
    [MOVEMENTS]: predictorMovementsModule,
    //[DEBUG]: predictorDebugModule
  }
  
  const bus = {
    relay: (target) => {
      return moduleMap[target];
    }
  }

  const initModules = (initData) => {
    Object.keys(constants).forEach(moduleKey => {
      console.log(moduleKey)
      moduleMap[moduleKey].init({
        moduleKey,
        bus,
        constants,
        data: initData[moduleKey]
      });
    });
  }

  const init = () => {
      /**
     * Initial Load
     */
    if (USE_SAMPLE_DATA) {
      initModules(getSampleData());
    } else {
      remoteCall({
        handler: (api) => api.getInitialData(),
        spinner: 'Loading configuration...',
        success: initModules,
        failure: 'Failed to load initial data'
      });
    }

    if (INITIAL_MODULE) {
      if (INITIAL_MODULE === LAUNCHER) {
        goHome();
      } else {
        navigate(INITIAL_MODULE);
      }
    }
  }

  const goHome = () => {
    navigate(LAUNCHER)
  };

  const navigate = (key) => {
    
    // Hide all modules
    document.querySelectorAll('.module-content').forEach(el => el.classList.remove('active'));
    
    // Show selected
    const targetId = `module-${constants[key].toLowerCase()}`;
    document.getElementById(targetId).classList.add('active');
    document.getElementById('current-module-title').innerText = key;
    document.getElementById('module-container').className = `for-${targetId}`;
    
    // Trigger module activation
    bus.relay(constants[key]).activate();
  };
  
  return {
    init,
    navigate,
    goHome
  }
})();

document.addEventListener('DOMContentLoaded', predictorModuleController.init);
//# sourceURL=js_main.js
</script>